// Derived from https://github.com/neetsdkasu/mt19937ar-MersenneTwister-JS/blob/master/mt19937ar.js
//
// Copyright (c) 2014, Leonardone @ NEETSDKASU
// All rights reserved.

// Redistribution and use in source and binary forms, with or without modification,
// are permitted provided that the following conditions are met:

// * Redistributions of source code must retain the above copyright notice, this
//   list of conditions and the following disclaimer.

// * Redistributions in binary form must reproduce the above copyright notice, this
//   list of conditions and the following disclaimer in the documentation and/or
//   other materials provided with the distribution.

// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
// ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
// WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
// DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR
// ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
// (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
// LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
// ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
// SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
function MersenneTwister(){function r(t){var n,$=[0,0,0,0],e=t;if(0!=e)for(n=0;n<4;++n)$[n]=255&e,e>>=8;this.getValue=function(){return($[0]|$[1]<<8|$[2]<<16)+($[3]<<16)*256},this.getBits=function(r){return $[3&r]},this.setBits=function(r,t){return $[3&r]=255&t},this.add=function(t){var n,e,i=new r(0),f=0;for(n=0;n<4;++n)e=$[n]+t.getBits(n)+f,i.setBits(n,e),f=e>>8;return i},this.sub=function(t){var n,e=new r(0),i=[0,0,0,0];for(n=0;n<4;++n)i[n]=$[n]-t.getBits(n),n>0&&i[n-1]<0&&--i[n];for(n=0;n<4;++n)e.setBits(n,i[n]);return e},this.mul=function(t){var n,e,i=new r(0),f=[0,0,0,0,0];for(n=0;n<4;++n){for(e=0;n+e<4;++e)f[n+e]+=$[n]*t.getBits(e);i.setBits(n,f[n]),f[n+1]+=f[n]>>8}return i},this.and=function(t){var n,e=new r(0);for(n=0;n<4;++n)e.setBits(n,$[n]&t.getBits(n));return e},this.or=function(t){var n,e=new r(0);for(n=0;n<4;++n)e.setBits(n,$[n]|t.getBits(n));return e},this.xor=function(t){var n,e=new r(0);for(n=0;n<4;++n)e.setBits(n,$[n]^t.getBits(n));return e},this.rshifta=function(t){var n,e=new r(0),i=[0,0,0,0,0],f=t>>3,s=0;for((128&$[3])>0&&(i[4]=s=255),n=0;n+f<4;++n)i[n]=$[n+f];for(;n<4;++n)i[n]=s;for(n=0,f=7&t;n<4;++n)e.setBits(n,(i[n]|i[n+1]<<8)>>f&255);return e},this.rshiftl=function(t){var n,e=new r(0),i=[0,0,0,0,0],f=t>>3;for(n=0;n+f<4;++n)i[n]=$[n+f];for(n=0,f=7&t;n<4;++n)e.setBits(n,(i[n]|i[n+1]<<8)>>f&255);return e},this.lshift=function(t){var n,e=new r(0),i=[0,0,0,0,0],f=t>>3;for(n=0;n+f<4;++n)i[n+f+1]=$[n];for(n=0,f=7&t;n<4;++n)e.setBits(n,(i[n]|i[n+1]<<8)<<f>>8&255);return e},this.equals=function(r){var t;for(t=0;t<4;++t)if($[t]!=r.getBits(t))return!1;return!0},this.compare=function(r){var t;for(t=3;t>=0;--t){if($[t]>r.getBits(t))return 1;if($[t]<r.getBits(t))return -1}return 0}}var t,n=new r(2567483615),$=new r(2147483648),e=new r(2147483647),i=new r(0),f=new r(1),s=function(r,t){var s,o;return(s=r,o=t,s.and($).or(o.and(e))).rshiftl(1).xor(t.and(f).equals(i)?i:n)},o=[],a=1,u=0,_=0;for(t=0;t<624;++t)o[t]=i;var h=function(t){var n,$=new r(1812433253);for(n=1,o[0]=new r(t);n<624;++n)o[n]=$.mul(o[n-1].xor(o[n-1].rshiftl(30))).add(new r(n));a=1,u=1};this.init_genrand=h,this.init_by_array=function(t,n){var $,e,i,f=new r(1664525),s=new r(1566083941);for(h(19650218),$=1,e=0,i=624>n?624:n;i;--i)o[$]=o[$].xor(o[$-1].xor(o[$-1].rshiftl(30)).mul(f)).add(new r(t[e])).add(new r(e)),$++,e++,$>=624&&(o[0]=o[623],$=1),e>=n&&(e=0);for(i=623;i;--i)o[$]=o[$].xor(o[$-1].xor(o[$-1].rshiftl(30)).mul(s)).sub(new r($)),++$>=624&&(o[0]=o[623],$=1);o[0]=new r(2147483648),a=1,u=1};var l=function(){var r,t=0;for(0==u&&h(5489),a=624,_=0,r=228;--r;++t)o[t]=o[t+397].xor(s(o[t],o[t+1]));for(r=397;--r;++t)o[t]=o[t+397-624].xor(s(o[t],o[t+1]));o[t]=o[t+397-624].xor(s(o[t],o[0]))},x=new r(2636928640),d=new r(4022730752),c=function(){var r;return 0==--a&&l(),r=o[_],++_,(r=(r=(r=(r=r.xor(r.rshiftl(11))).xor(r.lshift(7).and(x))).xor(r.lshift(15).and(d))).xor(r.rshiftl(18))).getValue()};this.genrand_int32=c,this.genrand_int31=function(){var r;return 0==--a&&l(),r=o[_],++_,(r=(r=(r=(r=r.xor(r.rshiftl(11))).xor(r.lshift(7).and(x))).xor(r.lshift(15).and(d))).xor(r.rshiftl(18))).rshiftl(1).getValue()},this.genrand_real1=function(){var r;return 0==--a&&l(),r=o[_],++_,(r=(r=(r=(r=r.xor(r.rshiftl(11))).xor(r.lshift(7).and(x))).xor(r.lshift(15).and(d))).xor(r.rshiftl(18))).getValue()*(1/4294967295)},this.genrand_real2=function(){var r;return 0==--a&&l(),r=o[_],++_,(r=(r=(r=(r=r.xor(r.rshiftl(11))).xor(r.lshift(7).and(x))).xor(r.lshift(15).and(d))).xor(r.rshiftl(18))).getValue()*(1/4294967296)},this.genrand_real3=function(){var r;return 0==--a&&l(),r=o[_],++_,((r=(r=(r=(r=r.xor(r.rshiftl(11))).xor(r.lshift(7).and(x))).xor(r.lshift(15).and(d))).xor(r.rshiftl(18))).getValue()+.5)*(1/4294967296)},this.genrand_res53=function(){var t=new r(c()).rshiftl(5).getValue(),n=new r(c()).rshiftl(6).getValue();return(67108864*t+n)*(1/9007199254740992)},this.genrand_sample=function(t,n){let $=Array.from({length:t},(r,t)=>t),e=[];for(let i=0;i<n;i++){let f=new r(c()),s=f.getValue()%$.length;e.push($[s]),$.splice(s,1)}return e}}